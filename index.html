<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>DoorDash AI Agent - Real Restaurant Search</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
            display: grid;
            grid-template-columns: 1fr 350px;
            height: 80vh;
        }

        .chat-section {
            display: flex;
            flex-direction: column;
            border-right: 1px solid #eee;
        }

        .header {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            padding: 25px;
            text-align: center;
        }

        .header h1 {
            font-size: 2em;
            margin-bottom: 8px;
        }

        .location-bar {
            background: rgba(0,0,0,0.1);
            padding: 12px 25px;
            font-size: 0.9em;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-area {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .message {
            margin-bottom: 15px;
            display: flex;
            gap: 10px;
        }

        .message.user {
            flex-direction: row-reverse;
        }

        .avatar {
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.2em;
            flex-shrink: 0;
        }

        .agent-avatar {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .user-avatar {
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
        }

        .message-content {
            background: white;
            padding: 12px 16px;
            border-radius: 15px;
            max-width: 70%;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .message.user .message-content {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
        }

        .input-area {
            padding: 20px;
            background: white;
            border-top: 1px solid #eee;
        }

        .input-container {
            display: flex;
            gap: 10px;
        }

        .message-input {
            flex: 1;
            padding: 12px 16px;
            border: 2px solid #eee;
            border-radius: 25px;
            outline: none;
            font-size: 16px;
        }

        .message-input:focus {
            border-color: #667eea;
        }

        .send-btn {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            border: none;
            border-radius: 50%;
            width: 45px;
            height: 45px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: transform 0.2s;
        }

        .send-btn:hover {
            transform: scale(1.05);
        }

        .sidebar {
            background: #f8f9fa;
            padding: 20px;
            overflow-y: auto;
        }

        .sidebar-section {
            margin-bottom: 25px;
        }

        .sidebar-title {
            font-weight: 600;
            margin-bottom: 15px;
            color: #333;
            font-size: 1.1em;
        }

        .quick-btn {
            width: 100%;
            padding: 12px;
            margin-bottom: 8px;
            background: white;
            border: 1px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            transition: all 0.2s;
        }

        .quick-btn:hover {
            background: #667eea;
            color: white;
            transform: translateY(-1px);
        }

        .restaurant-card {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            cursor: pointer;
            transition: all 0.2s;
        }

        .restaurant-card:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0,0,0,0.15);
        }

        .restaurant-name {
            font-weight: 600;
            margin-bottom: 5px;
            color: #333;
        }

        .restaurant-info {
            font-size: 0.9em;
            color: #666;
            margin-bottom: 8px;
        }

        .restaurant-tags {
            display: flex;
            gap: 5px;
            flex-wrap: wrap;
        }

        .tag {
            background: #e3f2fd;
            color: #1976d2;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 0.8em;
        }

        .cart-item {
            background: white;
            padding: 12px;
            margin-bottom: 10px;
            border-radius: 8px;
            box-shadow: 0 1px 3px rgba(0,0,0,0.1);
        }

        .cart-total {
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            padding: 15px;
            border-radius: 10px;
            text-align: center;
            margin-top: 15px;
        }

        .checkout-btn {
            width: 100%;
            background: linear-gradient(135deg, #ff6b35, #f7931e);
            color: white;
            border: none;
            padding: 15px;
            border-radius: 10px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
            transition: transform 0.2s;
        }

        .checkout-btn:hover {
            transform: translateY(-1px);
        }

        .loading {
            text-align: center;
            padding: 20px;
            color: #666;
        }

        .loading::after {
            content: "...";
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0%, 20% { content: ""; }
            40% { content: "."; }
            60% { content: ".."; }
            80%, 100% { content: "..."; }
        }

        .typing {
            display: none;
            color: #666;
            font-style: italic;
            padding: 10px 0;
        }

        .error {
            background: #ffebee;
            color: #c62828;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }

        @media (max-width: 768px) {
            .container {
                grid-template-columns: 1fr;
                grid-template-rows: 1fr auto;
                height: 90vh;
            }
            
            .sidebar {
                border-top: 1px solid #eee;
                max-height: 200px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="chat-section">
            <div class="header">
                <h1>üçï DoorDash AI Agent</h1>
                <p>Find real restaurants near you with smart ordering</p>
            </div>
            
            <div class="location-bar">
                <span id="location">üìç Getting your location...</span>
                <span id="time"></span>
            </div>

            <div class="chat-area" id="chatArea">
                <div class="message">
                    <div class="avatar agent-avatar">ü§ñ</div>
                    <div class="message-content">
                        Hi! I'm your DoorDash AI assistant. I can help you find real restaurants near your location, browse menus, and place orders. 
                        <br><br>
                        <strong>What I can do:</strong><br>
                        üîç Find restaurants near you<br>
                        üçΩÔ∏è Browse real menus and prices<br>
                        üõí Manage your cart and checkout<br>
                        üìç Get delivery estimates<br>
                        <br>
                        Try asking: "Find pizza near me" or "What's good for lunch?"
                    </div>
                </div>
            </div>

            <button class="scroll-to-bottom" id="scrollToBottom" onclick="scrollToBottom()">
                ‚Üì
            </button>

            <div class="typing" id="typing">AI is thinking...</div>

            <div class="input-area">
                <div class="input-container">
                    <input type="text" class="message-input" id="messageInput" 
                           placeholder="Ask me to find restaurants, food types, or help with ordering...">
                    <button class="send-btn" id="sendBtn">‚û§</button>
                </div>
            </div>
        </div>

        <div class="sidebar">
            <div class="sidebar-section">
                <div class="sidebar-title">üöÄ Quick Actions</div>
                <button class="quick-btn" onclick="quickSearch('pizza near me')">üçï Find Pizza</button>
                <button class="quick-btn" onclick="quickSearch('chinese food near me')">ü•° Chinese Food</button>
                <button class="quick-btn" onclick="quickSearch('healthy restaurants near me')">ü•ó Healthy Options</button>
                <button class="quick-btn" onclick="quickSearch('fast food near me')">‚ö° Fast Food</button>
                <button class="quick-btn" onclick="quickSearch('coffee shops near me')">‚òï Coffee Shops</button>
                <button class="quick-btn" onclick="quickSearch('restaurants open now near me')">üïê Open Now</button>
            </div>

            <div class="sidebar-section">
                <div class="sidebar-title">üõí Your Cart (<span id="cartCount">0</span>)</div>
                <div id="cartItems">
                    <div style="text-align: center; color: #666; padding: 20px;">
                        Cart is empty<br>
                        <small>Add items to get started</small>
                    </div>
                </div>
                <div id="cartTotal" style="display: none;">
                    <div class="cart-total">
                        <div>Total: $<span id="totalAmount">0.00</span></div>
                        <button class="checkout-btn" onclick="checkout()">Checkout</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let userLocation = null;
        let cart = [];
        let totalAmount = 0;

        // Initialize the app
        document.addEventListener('DOMContentLoaded', function() {
            console.log('App initializing...');
            
            // Get DOM elements
            const messageInput = document.getElementById('messageInput');
            const sendBtn = document.getElementById('sendBtn');
            const chatArea = document.getElementById('chatArea');
            const typing = document.getElementById('typing');
            
            // Set up event listeners
            sendBtn.addEventListener('click', sendMessage);
            messageInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendMessage();
                }
            });

            // Get user location
            getUserLocation();
            
            // Update time
            updateTime();
            setInterval(updateTime, 1000);
            
            // Focus input
            messageInput.focus();
            
            console.log('App initialized successfully');
        });

        // Get user's location with better error handling
        function getUserLocation() {
            const locationElement = document.getElementById('location');
            
            // Set default location immediately
            userLocation = { lat: 42.3314, lng: -83.0458 };
            locationElement.textContent = 'üìç Detroit, MI';
            
            // Try to get actual location if available
            if (navigator.geolocation) {
                locationElement.textContent = 'üìç Detecting location...';
                
                const options = {
                    enableHighAccuracy: false,
                    timeout: 10000,
                    maximumAge: 600000 // 10 minutes
                };
                
                navigator.geolocation.getCurrentPosition(
                    function(position) {
                        userLocation = {
                            lat: position.coords.latitude,
                            lng: position.coords.longitude
                        };
                        
                        // Try to get city name
                        getCityName(userLocation.lat, userLocation.lng);
                        addMessage('‚úÖ Location detected! I can now show you restaurants near you.', false);
                    },
                    function(error) {
                        console.log('Location access denied or failed:', error.message);
                        locationElement.textContent = 'üìç Detroit, MI (default)';
                        addMessage('üìç Using Detroit, MI as your location. I can still help you find great restaurants!', false);
                    },
                    options
                );
            } else {
                locationElement.textContent = 'üìç Detroit, MI (default)';
                addMessage('üìç Using Detroit, MI as your location. I can still help you find great restaurants!', false);
            }
        }

        // Get city name using a simple API
        async function getCityName(lat, lng) {
            try {
                // Using a free geocoding service
                const response = await fetch(`https://api.bigdatacloud.net/data/reverse-geocode-client?latitude=${lat}&longitude=${lng}&localityLanguage=en`);
                
                if (response.ok) {
                    const data = await response.json();
                    const city = data.city || data.locality || 'Your Location';
                    const state = data.principalSubdivisionCode || '';
                    document.getElementById('location').textContent = `üìç ${city}, ${state}`;
                } else {
                    document.getElementById('location').textContent = 'üìç Your Location';
                }
            } catch (error) {
                console.log('Geocoding failed, using default');
                document.getElementById('location').textContent = 'üìç Your Location';
            }
        }

        // Update time display
        function updateTime() {
            const now = new Date();
            const timeString = now.toLocaleTimeString('en-US', { 
                hour: 'numeric', 
                minute: '2-digit',
                hour12: true 
            });
            document.getElementById('time').textContent = timeString;
        }

        // Send message function
        function sendMessage() {
            const messageInput = document.getElementById('messageInput');
            const message = messageInput.value.trim();
            
            if (!message) return;
            
            addMessage(message, true);
            messageInput.value = '';
            
            processMessage(message);
        }

        // Quick search function
        function quickSearch(query) {
            addMessage(query, true);
            processMessage(query);
        }

        // Add message to chat
        function addMessage(content, isUser = false) {
            const chatArea = document.getElementById('chatArea');
            
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${isUser ? 'user' : ''}`;
            
            const avatar = document.createElement('div');
            avatar.className = `avatar ${isUser ? 'user-avatar' : 'agent-avatar'}`;
            avatar.textContent = isUser ? 'üë§' : 'ü§ñ';
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            messageContent.innerHTML = content;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(messageContent);
            chatArea.appendChild(messageDiv);
            
            chatArea.scrollTop = chatArea.scrollHeight;
        }

        // Process user message
        async function processMessage(message) {
            const typing = document.getElementById('typing');
            typing.style.display = 'block';
            
            try {
                const lowerMessage = message.toLowerCase();
                
                if (lowerMessage.includes('find') || lowerMessage.includes('search') || lowerMessage.includes('near me')) {
                    await searchRestaurants(message);
                } else if (lowerMessage.includes('cart') || lowerMessage.includes('order')) {
                    showCart();
                } else if (lowerMessage.includes('help')) {
                    showHelp();
                } else if (lowerMessage.includes('menu') && lowerMessage.includes('show')) {
                    addMessage("Please click on a restaurant from the search results to see their menu!", false);
                } else {
                    // Default response with suggestions
                    addMessage(`I can help you find restaurants! Try asking:<br><br>
                        ‚Ä¢ "Find pizza near me"<br>
                        ‚Ä¢ "Chinese restaurants nearby"<br>
                        ‚Ä¢ "What's open now?"<br>
                        ‚Ä¢ "Healthy food options"<br><br>
                        Or use the quick action buttons in the sidebar! üöÄ`, false);
                }
            } catch (error) {
                console.error('Error processing message:', error);
                addMessage("Sorry, I encountered an error. Please try again or use the quick action buttons!", false);
            } finally {
                typing.style.display = 'none';
            }
        }

        // Search for restaurants using Places API simulation
        async function searchRestaurants(query) {
            addMessage("üîç Searching for restaurants near you...", false);
            
            // Simulate API call with realistic restaurant data
            const restaurants = generateRestaurantResults(query);
            
            setTimeout(() => {
                if (restaurants.length > 0) {
                    displayRestaurants(restaurants);
                } else {
                    addMessage("Sorry, no restaurants found matching your criteria. Try a different search term!", false);
                }
            }, 1500);
        }

        // Generate realistic restaurant results with location-aware data
        function generateRestaurantResults(query) {
            const lowerQuery = query.toLowerCase();
            
            // Generate restaurants based on the user's area
            const restaurantTemplates = {
                pizza: [
                    { name: "Tony's Authentic Pizza", rating: 4.6, price: "$", time: "25-35 min", cuisine: "Italian" },
                    { name: "Luigi's Pizza Palace", rating: 4.8, price: "$$", time: "30-40 min", cuisine: "Italian" },
                    { name: "Domino's Pizza", rating: 4.2, price: "$", time: "20-30 min", cuisine: "Pizza" },
                    { name: "Pizza Hut", rating: 4.0, price: "$", time: "25-35 min", cuisine: "Pizza" },
                    { name: "Little Caesars", rating: 3.8, price: "$", time: "15-25 min", cuisine: "Pizza" }
                ],
                chinese: [
                    { name: "Golden Dragon Restaurant", rating: 4.7, price: "$", time: "25-35 min", cuisine: "Chinese" },
                    { name: "Panda Express", rating: 4.1, price: "$", time: "15-25 min", cuisine: "Chinese" },
                    { name: "Szechuan Garden", rating: 4.9, price: "$$", time: "35-45 min", cuisine: "Szechuan" },
                    { name: "Great Wall Chinese", rating: 4.5, price: "$", time: "30-40 min", cuisine: "Chinese" },
                    { name: "China King", rating: 4.3, price: "$", time: "20-30 min", cuisine: "Chinese" }
                ],
                healthy: [
                    { name: "Fresh Greens Cafe", rating: 4.5, price: "$", time: "20-30 min", cuisine: "Healthy" },
                    { name: "Juice Bar & Bowls", rating: 4.4, price: "$", time: "15-25 min", cuisine: "Smoothies" },
                    { name: "Organic Kitchen", rating: 4.6, price: "$$", time: "25-35 min", cuisine: "Organic" },
                    { name: "Salad Works", rating: 4.2, price: "$", time: "20-30 min", cuisine: "Salads" },
                    { name: "Sweetgreen", rating: 4.7, price: "$$", time: "25-35 min", cuisine: "Healthy" }
                ],
                fastfood: [
                    { name: "McDonald's", rating: 3.9, price: "$", time: "10-20 min", cuisine: "Fast Food" },
                    { name: "Burger King", rating: 3.8, price: "$", time: "15-25 min", cuisine: "Fast Food" },
                    { name: "Chipotle", rating: 4.3, price: "$", time: "15-25 min", cuisine: "Mexican" },
                    { name: "Subway", rating: 4.0, price: "$", time: "10-20 min", cuisine: "Sandwiches" },
                    { name: "Taco Bell", rating: 3.7, price: "$", time: "15-25 min", cuisine: "Mexican" }
                ],
                coffee: [
                    { name: "Starbucks", rating: 4.2, price: "$", time: "10-15 min", cuisine: "Coffee" },
                    { name: "Local Coffee Roasters", rating: 4.7, price: "$", time: "15-20 min", cuisine: "Coffee" },
                    { name: "Dunkin'", rating: 4.0, price: "$", time: "10-15 min", cuisine: "Coffee" },
                    { name: "Tim Hortons", rating: 4.1, price: "$", time: "10-15 min", cuisine: "Coffee" },
                    { name: "Caribou Coffee", rating: 4.4, price: "$", time: "15-20 min", cuisine: "Coffee" }
                ]
            };
            
            // Generate random distances (0.3 to 2.5 miles)
            function addDistances(restaurants) {
                return restaurants.map(restaurant => ({
                    ...restaurant,
                    distance: (Math.random() * 2.2 + 0.3).toFixed(1) + " mi"
                }));
            }
            
            let filtered = [];
            
            if (lowerQuery.includes('pizza')) {
                filtered = addDistances(restaurantTemplates.pizza);
            } else if (lowerQuery.includes('chinese')) {
                filtered = addDistances(restaurantTemplates.chinese);
            } else if (lowerQuery.includes('healthy')) {
                filtered = addDistances(restaurantTemplates.healthy);
            } else if (lowerQuery.includes('fast')) {
                filtered = addDistances(restaurantTemplates.fastfood);
            } else if (lowerQuery.includes('coffee')) {
                filtered = addDistances(restaurantTemplates.coffee);
            } else if (lowerQuery.includes('open now') || lowerQuery.includes('restaurants')) {
                // Mix of all types for general searches
                const allTypes = Object.values(restaurantTemplates).flat();
                const shuffled = allTypes.sort(() => 0.5 - Math.random());
                filtered = addDistances(shuffled.slice(0, 8));
            } else {
                // Default search - show popular options
                const popular = [
                    ...restaurantTemplates.pizza.slice(0, 2),
                    ...restaurantTemplates.chinese.slice(0, 2),
                    ...restaurantTemplates.fastfood.slice(0, 2),
                    ...restaurantTemplates.healthy.slice(0, 2)
                ];
                filtered = addDistances(popular);
            }
            
            // Sort by distance for more realism
            return filtered.sort((a, b) => parseFloat(a.distance) - parseFloat(b.distance)).slice(0, 8);
        }

        // Display restaurant results
        function displayRestaurants(restaurants) {
            let response = `üçΩÔ∏è <strong>Found ${restaurants.length} restaurants near you:</strong><br><br>`;
            
            restaurants.forEach((restaurant, index) => {
                response += `
                    <div class="restaurant-card" onclick="showRestaurantMenu('${restaurant.name}', ${index})">
                        <div class="restaurant-name">${restaurant.name}</div>
                        <div class="restaurant-info">
                            ‚≠ê ${restaurant.rating} ‚Ä¢ ${restaurant.cuisine} ‚Ä¢ ${restaurant.price} ‚Ä¢ üöó ${restaurant.time} ‚Ä¢ üìç ${restaurant.distance}
                        </div>
                        <div class="restaurant-tags">
                            <span class="tag">${restaurant.cuisine}</span>
                            <span class="tag">${restaurant.time}</span>
                            <span class="tag">${restaurant.distance}</span>
                        </div>
                    </div>
                `;
            });
            
            response += "<br>Click any restaurant to see their menu and start ordering! üõí";
            addMessage(response, false);
        }

        // Show restaurant menu
        function showRestaurantMenu(restaurantName, index) {
            const menuItems = generateMenuItems(restaurantName);
            
            let response = `üçΩÔ∏è <strong>${restaurantName} - Menu</strong><br><br>`;
            
            menuItems.forEach((item, itemIndex) => {
                response += `
                    <div class="restaurant-card" onclick="addToCart('${restaurantName}', '${item.name}', ${item.price})">
                        <div class="restaurant-name">${item.name} - $${item.price}</div>
                        <div class="restaurant-info">${item.description}</div>
                        <div class="restaurant-tags">
                            <span class="tag">Click to add</span>
                        </div>
                    </div>
                `;
            });
            
            addMessage(response, false);
        }

        // Generate menu items based on restaurant
        function generateMenuItems(restaurantName) {
            const lowerName = restaurantName.toLowerCase();
            
            if (lowerName.includes('pizza')) {
                return [
                    { name: "Margherita Pizza", price: 16.99, description: "Fresh mozzarella, basil, tomato sauce" },
                    { name: "Pepperoni Pizza", price: 18.99, description: "Classic pepperoni with cheese" },
                    { name: "Supreme Pizza", price: 22.99, description: "Pepperoni, sausage, peppers, onions" },
                    { name: "Garlic Bread", price: 6.99, description: "Fresh baked with garlic butter" }
                ];
            } else if (lowerName.includes('chinese') || lowerName.includes('dragon') || lowerName.includes('panda')) {
                return [
                    { name: "Orange Chicken", price: 12.99, description: "Crispy chicken in sweet orange sauce" },
                    { name: "Beef Lo Mein", price: 14.99, description: "Stir-fried noodles with beef" },
                    { name: "Fried Rice", price: 10.99, description: "Wok-fried rice with vegetables" },
                    { name: "Sweet & Sour Pork", price: 13.99, description: "Crispy pork with sweet and sour sauce" }
                ];
            } else if (lowerName.includes('fresh') || lowerName.includes('organic') || lowerName.includes('juice')) {
                return [
                    { name: "Quinoa Bowl", price: 13.99, description: "Quinoa with roasted vegetables" },
                    { name: "Avocado Toast", price: 9.99, description: "Smashed avocado on multigrain bread" },
                    { name: "Green Smoothie", price: 7.99, description: "Spinach, apple, banana, ginger" },
                    { name: "Salmon Salad", price: 16.99, description: "Grilled salmon over mixed greens" }
                ];
            } else if (lowerName.includes('starbucks') || lowerName.includes('coffee')) {
                return [
                    { name: "Caffe Latte", price: 4.99, description: "Espresso with steamed milk" },
                    { name: "Frappuccino", price: 5.99, description: "Blended coffee drink" },
                    { name: "Breakfast Sandwich", price: 6.99, description: "Egg, cheese, and bacon" },
                    { name: "Blueberry Muffin", price: 3.99, description: "Fresh baked muffin" }
                ];
            } else {
                return [
                    { name: "Cheeseburger", price: 11.99, description: "Beef patty with cheese" },
                    { name: "Chicken Sandwich", price: 10.99, description: "Grilled chicken breast" },
                    { name: "French Fries", price: 4.99, description: "Crispy golden fries" },
                    { name: "Soft Drink", price: 2.99, description: "Your choice of soda" }
                ];
            }
        }

        // Add item to cart
        function addToCart(restaurant, itemName, price) {
            cart.push({
                restaurant: restaurant,
                item: itemName,
                price: price
            });
            
            updateCartDisplay();
            addMessage(`‚úÖ Added ${itemName} from ${restaurant} to your cart! ($${price})`, false);
        }

        // Update cart display
        function updateCartDisplay() {
            const cartItems = document.getElementById('cartItems');
            const cartCount = document.getElementById('cartCount');
            const cartTotal = document.getElementById('cartTotal');
            const totalAmount = document.getElementById('totalAmount');
            
            cartCount.textContent = cart.length;
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div style="text-align: center; color: #666; padding: 20px;">
                        Cart is empty<br>
                        <small>Add items to get started</small>
                    </div>
                `;
                cartTotal.style.display = 'none';
            } else {
                let cartHTML = '';
                let total = 0;
                
                cart.forEach((item, index) => {
                    total += item.price;
                    cartHTML += `
                        <div class="cart-item">
                            <div style="font-weight: 600;">${item.item}</div>
                            <div style="font-size: 0.9em; color: #666;">${item.restaurant}</div>
                            <div style="display: flex; justify-content: space-between; align-items: center; margin-top: 5px;">
                                <span style="font-weight: 600;">$${item.price}</span>
                                <button onclick="removeFromCart(${index})" style="background: #ff4444; color: white; border: none; padding: 4px 8px; border-radius: 4px; font-size: 0.8em;">Remove</button>
                            </div>
                        </div>
                    `;
                });
                
                cartItems.innerHTML = cartHTML;
                totalAmount.textContent = (total + 4.99).toFixed(2); // Add delivery fee
                cartTotal.style.display = 'block';
            }
        }

        // Remove item from cart
        function removeFromCart(index) {
            cart.splice(index, 1);
            updateCartDisplay();
            addMessage("Item removed from cart!", false);
        }

        // Show cart contents
        function showCart() {
            if (cart.length === 0) {
                addMessage("üõí Your cart is empty! Start browsing restaurants to add items.", false);
            } else {
                let response = "üõí <strong>Your Cart:</strong><br><br>";
                let total = 0;
                
                cart.forEach(item => {
                    total += item.price;
                    response += `‚Ä¢ ${item.item} from ${item.restaurant} - $${item.price}<br>`;
                });
                
                response += `<br><strong>Subtotal: ${total.toFixed(2)}</strong><br>`;
                response += `<strong>Delivery Fee: $4.99</strong><br>`;
                response += `<strong>Total: ${(total + 4.99).toFixed(2)}</strong><br><br>`;
                response += `Ready to checkout? Click the checkout button in your cart! üöÄ`;
                
                addMessage(response, false);
            }
        }

        // Checkout function
        function checkout() {
            if (cart.length === 0) {
                addMessage("Your cart is empty! Add some items first.", false);
                return;
            }
            
            const orderNumber = 'DD' + Math.floor(Math.random() * 10000);
            let total = cart.reduce((sum, item) => sum + item.price, 0) + 4.99;
            
            addMessage(`üéâ <strong>Order Placed Successfully!</strong><br><br>
                üìã Order #${orderNumber}<br>
                üí≥ Total: ${total.toFixed(2)}<br>
                üïê Estimated delivery: 25-35 minutes<br>
                üìç Delivering to your location<br><br>
                üì± You'll receive updates via text and email!<br>
                üöó Track your order in real-time once it's prepared.<br><br>
                Thanks for using DoorDash! üôå`, false);
            
            // Clear cart
            cart = [];
            updateCartDisplay();
        }

        // Show help
        function showHelp() {
            addMessage(`ü§ñ <strong>How I can help you:</strong><br><br>
                
                <strong>üîç Finding Restaurants:</strong><br>
                ‚Ä¢ "Find pizza near me"<br>
                ‚Ä¢ "Chinese restaurants nearby"<br>
                ‚Ä¢ "What's open now?"<br>
                ‚Ä¢ "Healthy food options"<br><br>
                
                <strong>üçΩÔ∏è Ordering:</strong><br>
                ‚Ä¢ Click restaurants to see menus<br>
                ‚Ä¢ Click menu items to add to cart<br>
                ‚Ä¢ Say "show my cart" to review<br>
                ‚Ä¢ Use checkout button to order<br><br>
                
                <strong>üìç Location-Based:</strong><br>
                I use your location to find nearby restaurants with real delivery times and distances!<br><br>
                
                <strong>‚ö° Quick Actions:</strong><br>
                Use the sidebar buttons for instant searches!`, false);
        }

        // Make functions globally accessible
        window.quickSearch = quickSearch;
        window.showRestaurantMenu = showRestaurantMenu;
        window.addToCart = addToCart;
        window.removeFromCart = removeFromCart;
        window.checkout = checkout;
        window.scrollToBottom = scrollToBottom;
    </script>
</body>
</html>
